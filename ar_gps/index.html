<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>GeoAR.js demo</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script>
      AFRAME.registerComponent('play-all-model-animations', {
        init: function () {
          this.model = null;
          this.mixer = null;

          var model = this.el.getObject3D('mesh');
          if (model) {
            this.load(model);
          } else {
            this.el.addEventListener('model-loaded', function (e) {
              this.load(e.detail.model);
            }.bind(this));
          }
        },

        load: function (model) {
          this.model = model;
          this.mixer = new THREE.AnimationMixer(model);
          this.model.animations.forEach(animation => {
            this.mixer.clipAction(animation, model).play();
          });
        },

        tick: function (t, dt) {
          if (this.mixer && !isNaN(dt)) {
            this.mixer.update(dt / 1000);
          }
        }
      });
    </script>
  </head>

  <body style="margin: 0; overflow: hidden;">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
    >
      <a-text
        value="text 1"
        look-at="[gps-camera]"
        scale="1 1 1"
        gps-entity-place="latitude: 20.61386735930226; longitude: -105.22958794930965;"
      ></a-text>

      <a-text
        value="text 2"
        look-at="[gps-camera]"
        scale="1 1 1"
        gps-entity-place="latitude: 20.613887; longitude: -105.229655;"
      ></a-text>

      <a-text
        value="text 3"
        scale="1 1 1"
        gps-entity-place="latitude: 20.613918; longitude: -105.229648;"
      ></a-text>

      <a-assets>
        <a-asset-item id="cityModel" src="https://cdn.aframe.io/test-models/models/glTF-2.0/virtualcity/VC.gltf"></a-asset-item>
      </a-assets>
      <a-entity gltf-model="#cityModel" play-all-model-animations modify-materials></a-entity>

      <!-- <a-assets>
        <a-asset-item id="tree" src="/assets/mammoth.gltf"></a-asset-item>
      </a-assets>

      <a-entity gltf-model="#tree" gps-entity-place="latitude: 20.613918; longitude: -105.229648;"></a-entity> -->

      <a-camera gps-camera="gpsMinDistance: 5" rotation-reader> </a-camera>
    </a-scene>
  </body>
</html>